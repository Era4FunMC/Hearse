From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: wangxyper <wangxyper@163.com>
Date: Thu, 5 Jan 2023 08:55:13 +0800
Subject: [PATCH] Petal Reduce sensor work


diff --git a/src/main/java/net/minecraft/world/entity/Mob.java b/src/main/java/net/minecraft/world/entity/Mob.java
index 1ce343e6e829df8032c7c7671329d71728b16154..9a68f659868d43782d8b00367c6aafc18d4a55a5 100644
--- a/src/main/java/net/minecraft/world/entity/Mob.java
+++ b/src/main/java/net/minecraft/world/entity/Mob.java
@@ -904,11 +904,11 @@ public abstract class Mob extends LivingEntity {
             }
             return;
         }
+        int i = this.level.getServer().getTickCount() + this.getId(); // petal - move up
         // Paper end
         //this.level.getProfiler().push("sensing"); // Purpur
-        this.sensing.tick();
+        if (i % 10 == 0) this.sensing.tick(); // petal - only refresh line of sight cache every half second
         //this.level.getProfiler().pop(); // Purpur
-        int i = this.level.getServer().getTickCount() + this.getId();
 
         MinecraftServer.getServer().asyncExecutor.executeWithCallBack(()->{
             if (i % 2 != 0 && this.tickCount > 1) {
